---
title: "R Notebook"
output: rmarkdown::github_document

---


# tidyYarns
tidyYarns is a function that binds the data from the types of yarns used in production

- Number of Millstyles
```{r}
length(unique(tidy_yarns$millstyle))
```

- Number of Yarns used in production 
```{r}
length(unique(tidy_yarns$yarn))
```

- types of yarn
```{r}
unique(tidy_yarns$type)
```

- number of purchased yarns
```{r}
unique_pur <- unique(tidy_yarns$yarn[which(tidy_yarns$type == 'Pur')])
num_pur <- length(unique_pur)
num_pur
```

- number of twisted yarns
```{r}
unique_twist <- unique(tidy_yarns$yarn[which(tidy_yarns$type == 'Twist')])
num_twist <- length(unique_twist)
num_twist
```

- number of dyed yarns
```{r}
unique_dye <- unique(tidy_yarns$yarn[which(tidy_yarns$type == 'Dye')])
num_dye <- length(unique_dye)
num_dye
```

- number of spun yarns 
```{r}
unique_spun <- unique(tidy_yarns$yarn[which(tidy_yarns$type == 'Spun')])
num_spun <- length(unique_spun)
num_spun
```

- Verify number of yarns
```{r}
num_pur + num_dye + num_twist + num_spun
```

- Unique Millstyles in tidy_yarns
```{r}
length(unique(tidy_yarns$millstyle))
```


- NAs present in dataframe
```{r}
checkNA(tidy_yarns)
```



# tidy_BOM Details

- Number of MillStyles
```{r}
length(unique(tidy_Bom$millstyle))
```

- Number of Yarns

It appears that there is a 93 yarn difference between the bill of materials (tidy_Boms) and tidyYarns (630 unique yarns present in tidy_yarns)
```{r}
length(unique(tidy_Bom$yarn))
```

The yarns that differ between the two sets are:
```{r}
yarn_diff <- setdiff(tidy_Bom$yarn, tidy_yarns$yarn)
yarn_diff
```

- numbers of yarns in difference
```{r}
length(yarn_diff)
```

It appears there is a 173 yarn difference between the two datasets. 

Let's look into this...

```{r}
common_yarns <- unique(tidy_yarns$yarn[tidy_yarns$yarn %in% tidy_Bom$yarn])
length(common_yarns)
```

So based on the calculation above, only 550 yarns are present in both data sets.

```{r}
'%nin%' <- Negate('%in%')
tidy_yarn_diff <- tidy_yarns$yarn[tidy_yarns$yarn %nin% tidy_Bom$yarn]
unique(tidy_yarn_diff)
```
```{r}
length(unique(tidy_yarn_diff))
```


```{r}
'%nin%' <- Negate('%in%')
tidy_Bom_diff <- tidy_Bom$yarn[tidy_Bom$yarn %nin% tidy_yarns$yarn]
unique(tidy_Bom_diff)
```
```{r}
length(unique(tidy_Bom_diff))
```


- intesection between the tidy_yarns$yarn and tidy_Bom$yarn
```{r}
tidy_bom_yarns_intersect <- intersect(tidy_yarns$yarn, tidy_Bom$yarn)
#tidy_bom_yarns_intersect
```


- number of common yarns between the two datasets
```{r}
length(tidy_bom_yarns_intersect)
```


- In regards to tidy_yarns$pounds, it is not specific as to what the amount listed per millstyle means


- Earliest Date Used Listed
```{r}
min(tidy_Bom$datelastused)
```

- Latest Date Used Listed
```{r}
max(tidy_Bom$datelastused)
```

The dates listed in tidy_Bom do not appear to have much significance in the progression of this analysis as the dates for each millstyle would continually change as production continues. These dates refer to the millstyle and not the yarn.


- NA Check
```{r}
checkNA(tidy_Bom)
```


# tidy_m365 Details

- number of millstyles present in m365

```{r}
length(unique(tidy_m365$millstyle))
```
For reference, the number of unique millstyles in tidy_Bom is 957 and 535 for tidy_yarns

- intersection (common millstyles) between tidy_m365$millstyle and tidy_BOM$millstyle
```{r}
intersect(tidy_m365$millstyle, tidy_Bom$millstyle)
```

```{r}
tidy_Bom_m365_diff <- tidy_m365$millstyle[tidy_m365$millstyle %nin% tidy_Bom$millstyle]
length(unique(tidy_Bom_m365_diff))
```


After using both the %nin% operator and the intersect function, it appears that tidy_Boms and tidy_m365 share no millstyles in common...No explanation at this time; warrants further exploration.

- intersection between tidy_m365$millstyle and tidy_yarns$millstyle
```{r}
intersect(tidy_m365$millstyle, tidy_yarns$millstyle)
```

Something is going on here; neither intersection returns any millstyles meaning there is something inherently wrong with the column formatting/transformation of tidy_m365 or the reference material provided does not reflect production


```{r}
tidy_yarn_m365_diff <- tidy_m365$millstyle[tidy_m365$millstyle %nin% tidy_yarns$millstyle]
length(unique(tidy_yarn_m365_diff))
```


- number of orders
```{r}
length(unique(tidy_m365$order))
```
- min and max dates
```{r}
min(tidy_m365$date)
```
```{r}
max(tidy_m365$date)
```

- time frame of data set
```{r}
max(tidy_m365$date) - min(tidy_m365$date)
```

- Check NAs
```{r}
checkNA(tidy_m365)
```

Unsure whether or not the order value is going to play much importance in analysis aside from having an impact on how data gets grouped when using dplyr. 



# tidyStops Details

tidyStops only contains details for stoppage information for range and not millstyle, 

- number of ranges
```{r}
length(unique(tidy_Stops$range))
```
Question is there a way to merge tables on the date and range to compute the stops for millstyle?

- min and max dates
```{r}
min(tidy_Stops$date)
```
```{r}
max(tidy_Stops$date)
```

- Check NAs
```{r}
checkNA(tidy_Stops)
```


# comp_Stops Details

comp_Stops is a dataframe that has summarized information (average ppm, totalpicks, and total combined stops) on the date, loom, and range.

```{r}
library(ggplot2)
loom_stops <- comp_Stops %>%
        group_by(loom) %>%
        summarise(totalstops = sum(totalcombinedstops),
                  totalpicks = sum(mpx),
                  picksperstop = (totalpicks/totalstops)) %>%
        print()
```

- quick plot of total stops over time frame

```{r}
qplot(x = loom_stops$loom, y = loom_stops$totalstops, geom = "point") 

```

- quick plot of total picks over the time frame

```{r}
qplot(x = loom_stops$loom, y = loom_stops$totalpicks)
```

- quick plot of picks per stop

```{r}
qplot(x = loom_stops$loom,
      y = loom_stops$picksperstop)
```

